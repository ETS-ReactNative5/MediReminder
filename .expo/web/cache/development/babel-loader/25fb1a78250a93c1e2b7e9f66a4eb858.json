{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { TextInput } from 'react-native-gesture-handler';\nimport { color } from 'react-native-reanimated';\nimport BarHeader from \"../shared/BarHeader\";\nimport avatar from \"../assets/favicon.png\";\nimport ToggleSwitch from 'toggle-switch-react-native';\nimport { doc, getDoc, onSnapshot, setDoc, updateDoc } from '@firebase/firestore';\nimport { useAuth } from \"../Context/AuthContext\";\nimport { db } from \"../firebase/Config\";\nimport { useUser } from \"../Context/UserContext\";\nexport default function AccountScreen(_ref) {\n  var setOpenAccount = _ref.setOpenAccount,\n      navigation = _ref.navigation;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isEditing = _useState2[0],\n      setIsEditing = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      saveLoading = _useState4[0],\n      setSaveLoading = _useState4[1];\n\n  var Info = function Info() {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var gender = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    var birthDate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n    var phoneNumber = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n    var bio = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : '';\n\n    _classCallCheck(this, Info);\n\n    this.name = name;\n    this.gender = gender;\n    this.birthDate = birthDate;\n    this.phoneNumber = phoneNumber;\n    this.bio = bio;\n  };\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      profile = _useState6[0],\n      setProfile = _useState6[1];\n\n  var _useState7 = useState(new Info()),\n      _useState8 = _slicedToArray(_useState7, 2),\n      info = _useState8[0],\n      setInfo = _useState8[1];\n\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser;\n\n  var handleClickSave = function handleClickSave() {\n    return _regeneratorRuntime.async(function handleClickSave$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setSaveLoading(true);\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(updateDoc(doc(db, 'users', currentUser.uid), {\n              info: profile\n            }));\n\n          case 4:\n            _context.next = 9;\n            break;\n\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](0);\n            console.log('Error in saving profile', _context.t0.message);\n\n          case 9:\n            console.log('Info saved: ', info);\n            setSaveLoading(false);\n            setIsEditing(false);\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 6]], Promise);\n  };\n\n  useEffect(function () {\n    var initializeProfile = function initializeProfile() {\n      var userDoc, user, profile;\n      return _regeneratorRuntime.async(function initializeProfile$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              userDoc = doc(db, 'users', currentUser.uid);\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(getDoc(userDoc));\n\n            case 3:\n              user = _context2.sent;\n              profile = user.data().info;\n\n              if (profile) {\n                _context2.next = 17;\n                break;\n              }\n\n              _context2.prev = 6;\n              _context2.next = 9;\n              return _regeneratorRuntime.awrap(setDoc(userDoc, {\n                info: {\n                  name: '',\n                  gender: '',\n                  birthDate: '',\n                  phoneNumber: '',\n                  bio: ''\n                }\n              }));\n\n            case 9:\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](6);\n              console.log('Error in initializing profile:', _context2.t0.message);\n\n            case 14:\n              console.log('Initializing profile successfully');\n              _context2.next = 18;\n              break;\n\n            case 17:\n              console.log('Profile already exists');\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[6, 11]], Promise);\n    };\n\n    initializeProfile();\n    var unsub = onSnapshot(doc(db, 'users', currentUser.uid), function (doc) {\n      var userInfo = doc.data().info;\n      setInfo(userInfo);\n    });\n  }, []);\n  return React.createElement(TouchableWithoutFeedback, {\n    onPress: function onPress() {\n      return Keyboard.dismiss();\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 1\n    }\n  }, React.createElement(BarHeader, {\n    navigation: navigation,\n    header: isEditing ? 'Edit Profile' : 'Profile'\n  }), React.createElement(Image, {\n    source: avatar,\n    style: styles.avatar\n  }), React.createElement(View, {\n    style: styles.container\n  }, React.createElement(View, null, React.createElement(View, {\n    style: styles.box\n  }, React.createElement(Text, null, \" Name \"), React.createElement(TextInput, {\n    onChangeText: function onChangeText(text) {\n      return setProfile(function (prevProfile) {\n        return _objectSpread(_objectSpread({}, prevProfile), {}, {\n          name: text\n        });\n      });\n    },\n    editable: isEditing,\n    textAlign: \"right\",\n    placeholder: \"Name\",\n    style: {\n      padding: 5\n    },\n    defaultValue: info.name == '' ? 'Name' : info.name\n  })), React.createElement(View, {\n    style: styles.box\n  }, React.createElement(Text, null, \"Gender\"), React.createElement(TextInput, {\n    onChangeText: function onChangeText(text) {\n      return setProfile(function (prevProfile) {\n        return _objectSpread(_objectSpread({}, prevProfile), {}, {\n          gender: text\n        });\n      });\n    },\n    editable: isEditing,\n    textAlign: \"right\",\n    placeholder: \"Gender\",\n    style: {\n      padding: 5\n    }\n  })), React.createElement(View, {\n    style: styles.box\n  }, React.createElement(Text, null, \"Birth date\"), React.createElement(TextInput, {\n    editable: isEditing,\n    textAlign: \"right\",\n    placeholder: \"Birth date\",\n    style: {\n      padding: 5\n    }\n  })), React.createElement(View, {\n    style: styles.box\n  }, React.createElement(Text, null, \"Phone number\"), React.createElement(TextInput, {\n    editable: isEditing,\n    textAlign: \"right\",\n    placeholder: \"Phone number\",\n    style: {\n      padding: 5\n    }\n  })), React.createElement(View, {\n    style: styles.box\n  }, React.createElement(Text, null, \"Bio\"), React.createElement(TextInput, {\n    editable: isEditing,\n    textAlign: \"right\",\n    placeholder: \"Bio\",\n    style: {\n      padding: 5\n    }\n  }))), !isEditing ? React.createElement(View, {\n    style: styles.buttonContainer\n  }, React.createElement(TouchableOpacity, {\n    style: styles.editButton,\n    onPress: function onPress() {\n      return setIsEditing(true);\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText\n  }, \"EDIT\"))) : React.createElement(View, {\n    style: styles.buttonContainer\n  }, React.createElement(TouchableOpacity, {\n    style: styles.editButton,\n    onPress: function onPress() {\n      return setIsEditing(false);\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText\n  }, \"BACK\")), React.createElement(TouchableOpacity, {\n    style: styles.editButton,\n    onPress: handleClickSave\n  }, saveLoading ? React.createElement(ActivityIndicator, {\n    size: \"small\",\n    color: \"black\"\n  }) : React.createElement(Text, {\n    style: styles.buttonText\n  }, \"SAVE\"))))));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 15,\n    justifyContent: 'space-between'\n  },\n  box: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingTop: 10,\n    borderBottomWidth: 1,\n    marginVertical: 5\n  },\n  avatar: {\n    alignSelf: 'center',\n    marginTop: 20,\n    borderRadius: 90,\n    width: 100,\n    height: 100\n  },\n  editButton: {\n    width: '40%',\n    backgroundColor: '#53cbff',\n    alignSelf: 'center',\n    padding: 10,\n    borderRadius: 10,\n    justifyContent: 'center'\n  },\n  buttonText: {\n    alignSelf: 'center',\n    fontSize: 20\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-evenly'\n  }\n});","map":{"version":3,"sources":["C:/Users/Admin/OneDrive/Máy tính/Projects/MediReminder/screens/AccountScreen.js"],"names":["React","useEffect","useState","TextInput","color","BarHeader","avatar","ToggleSwitch","doc","getDoc","onSnapshot","setDoc","updateDoc","useAuth","db","useUser","AccountScreen","setOpenAccount","navigation","isEditing","setIsEditing","saveLoading","setSaveLoading","Info","name","gender","birthDate","phoneNumber","bio","profile","setProfile","info","setInfo","currentUser","handleClickSave","uid","console","log","message","initializeProfile","userDoc","user","data","unsub","userInfo","Keyboard","dismiss","flex","styles","container","box","text","prevProfile","padding","buttonContainer","editButton","buttonText","StyleSheet","create","justifyContent","flexDirection","alignItems","paddingTop","borderBottomWidth","marginVertical","alignSelf","marginTop","borderRadius","width","height","backgroundColor","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { StyleSheet, Text, View, Button, Image, TouchableOpacity, TouchableWithoutFeedback, Keyboard, ActivityIndicator } from 'react-native'\r\nimport { TextInput } from 'react-native-gesture-handler'\r\nimport { color } from 'react-native-reanimated'\r\nimport BarHeader from '../shared/BarHeader'\r\nimport avatar from '../assets/favicon.png';\r\nimport ToggleSwitch from 'toggle-switch-react-native';\r\nimport { doc, getDoc, onSnapshot, setDoc, updateDoc } from '@firebase/firestore'\r\nimport { useAuth } from '../Context/AuthContext'\r\nimport { db } from '../firebase/Config'\r\nimport { useUser } from '../Context/UserContext'\r\n\r\nexport default function AccountScreen({setOpenAccount, navigation}) {\r\n    const [isEditing, setIsEditing] = useState(false)\r\n    const [saveLoading, setSaveLoading] = useState(false)\r\n\r\n    class Info {\r\n        constructor(name = '', gender = '', birthDate = '', phoneNumber = '', bio = '') {\r\n            this.name = name\r\n            this.gender = gender\r\n            this.birthDate = birthDate\r\n            this.phoneNumber = phoneNumber\r\n            this.bio = bio\r\n        }\r\n    }\r\n\r\n    const [profile, setProfile] = useState()\r\n    const [info, setInfo] = useState(new Info())\r\n\r\n    const { currentUser } = useAuth()\r\n    // const { info } = useUser()\r\n\r\n\r\n    // useEffect(\r\n    //     () => {\r\n    //         // setInfo(new Info())\r\n            \r\n    //         const unsub = onSnapshot(doc(db, 'users', currentUser.uid), doc => {\r\n    //             const userInfo = doc.data().info\r\n    //             // console.log(userInfo);\r\n\r\n    //             setInfo(userInfo)\r\n    //         })\r\n    //     }\r\n    // , [])\r\n\r\n    const handleClickSave =  async () => {\r\n\r\n        try {\r\n            setSaveLoading(true)\r\n            await updateDoc(doc(db, 'users', currentUser.uid), {\r\n                info : profile\r\n            })\r\n            // await setDoc(doc(db, 'users', currentUser.uid), {\r\n            //     info : profile\r\n            // })\r\n        } catch (e) {\r\n            console.log('Error in saving profile', e.message);\r\n        }\r\n\r\n        console.log('Info saved: ', info);\r\n        setSaveLoading(false)\r\n        setIsEditing(false)\r\n    }\r\n\r\n    useEffect(\r\n        () => {\r\n            const initializeProfile = async () => {\r\n                const userDoc = doc(db, 'users', currentUser.uid)\r\n                const user = await getDoc(userDoc)\r\n                const profile = user.data().info\r\n\r\n                if (!profile) {\r\n                    try {\r\n                        // const newInfo = new Info()\r\n                        await setDoc(userDoc, {info: {\r\n                            name: '',\r\n                            gender: '',\r\n                            birthDate: '',\r\n                            phoneNumber: '',\r\n                            bio: ''\r\n                        }})\r\n                    } catch (error) {\r\n                        console.log('Error in initializing profile:', error.message);\r\n                    }\r\n\r\n                    console.log('Initializing profile successfully');\r\n                } else {\r\n                    console.log('Profile already exists');\r\n                }\r\n\r\n                // setInfo(() => profile)\r\n            }\r\n\r\n            initializeProfile()\r\n\r\n            const unsub = onSnapshot(doc(db, 'users', currentUser.uid), doc => {\r\n                const userInfo = doc.data().info\r\n                // console.log(userInfo);\r\n\r\n                setInfo(userInfo)\r\n            })\r\n\r\n        }\r\n    , [])\r\n\r\n    // useEffect(\r\n    //     () => {\r\n    //         // const getUserInfo = async () => {\r\n    //         //     const user = await getDoc(userDoc)\r\n    //         //     const profile = user.data().info\r\n    //         //     console.log(profile);\r\n    //         //     setInfo(prevProfile => profile)\r\n    //         //     console.log(info);\r\n    //         // }\r\n\r\n    //         // getUserInfo()\r\n    //     }\r\n    // , [])\r\n\r\n    // // useEffect(\r\n    // //     () => {\r\n    // //         const getUserInfo = async () => {\r\n    // //             const user = await getDoc(doc(db, 'users', currentUser.uid))\r\n    // //             setInfo( () => user.data().info )\r\n    // //             console.log(info);\r\n    // //         }\r\n    // //         getUserInfo()\r\n\r\n    // //     }\r\n    // // , [])\r\n\r\n    return (\r\n    <TouchableWithoutFeedback\r\n        onPress={() => Keyboard.dismiss()}\r\n    >\r\n        <View style={{flex: 1}}>\r\n            <BarHeader navigation={navigation} header={isEditing ? 'Edit Profile' : 'Profile'}/>\r\n            <Image source={avatar} style={styles.avatar} />\r\n\r\n            <View style={styles.container}>\r\n                <View>\r\n                    <View style={styles.box}>\r\n                        <Text> Name </Text>\r\n                        <TextInput \r\n                        onChangeText={text => setProfile( prevProfile => ({...prevProfile, name: text}))}\r\n                        editable={isEditing}\r\n                        textAlign='right' \r\n                        placeholder='Name' \r\n                        style={{padding: 5}}\r\n                        // value={info.name}\r\n                        defaultValue={info.name == '' ? 'Name' : info.name}\r\n                        />\r\n                    </View>\r\n\r\n                    <View style={styles.box}>\r\n                        <Text>Gender</Text>\r\n                        <TextInput\r\n                        onChangeText={text => setProfile( prevProfile => ({...prevProfile, gender: text}))}\r\n                        editable={isEditing}\r\n                        textAlign='right'\r\n                        placeholder='Gender' \r\n                        style={{padding: 5}}\r\n                        // defaultValue={info.gender}\r\n                        />\r\n                    </View> \r\n                    \r\n                    <View style={styles.box}>\r\n                        <Text>Birth date</Text>\r\n                        <TextInput editable={isEditing} textAlign='right' placeholder='Birth date' style={{padding: 5}}></TextInput>\r\n                    </View>\r\n\r\n                    <View style={styles.box}>\r\n                        <Text>Phone number</Text>\r\n                        <TextInput editable={isEditing} textAlign='right' placeholder='Phone number' style={{padding: 5}}></TextInput>\r\n                    </View>\r\n\r\n                    <View style={styles.box}>\r\n                        <Text>Bio</Text>\r\n                        <TextInput editable={isEditing} textAlign='right' placeholder='Bio' style={{padding: 5}}></TextInput>\r\n                    </View>\r\n                </View>\r\n\r\n                { !isEditing ? \r\n                    <View style={styles.buttonContainer}>\r\n                        <TouchableOpacity\r\n                        style={styles.editButton}\r\n                        onPress={() => setIsEditing(true)}\r\n                        >\r\n                            <Text style={styles.buttonText}>EDIT</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                :\r\n                    <View style={styles.buttonContainer}>\r\n                        <TouchableOpacity\r\n                        style={styles.editButton}\r\n                        onPress={() => setIsEditing(false)}\r\n                        >\r\n                            <Text style={styles.buttonText}>BACK</Text>\r\n                        </TouchableOpacity>\r\n\r\n                        <TouchableOpacity\r\n                        style={styles.editButton}\r\n                        onPress={handleClickSave}\r\n                        >\r\n                            {saveLoading ? <ActivityIndicator size='small' color='black' /> : <Text style={styles.buttonText}>SAVE</Text> }\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                    \r\n                }\r\n            </View>\r\n\r\n\r\n        </View>\r\n    </TouchableWithoutFeedback>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        padding: 15,\r\n        justifyContent: 'space-between',\r\n        // alignItems :'center'\r\n    },\r\n    box: {\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-between',\r\n        paddingTop: 10,\r\n        borderBottomWidth: 1,\r\n        marginVertical: 5\r\n        // backgroundColor: 'gray'\r\n    },\r\n    avatar: {\r\n        alignSelf :'center',\r\n        marginTop: 20,\r\n        // backgroundColor: 'gray',\r\n        borderRadius: 90,\r\n        width: 100,\r\n        height: 100,\r\n    },\r\n    editButton: {\r\n        width: '40%',\r\n        backgroundColor: '#53cbff',\r\n        alignSelf: 'center',\r\n        padding: 10,\r\n        borderRadius: 10,\r\n        justifyContent: 'center'\r\n    },\r\n    buttonText: {\r\n        alignSelf: 'center',\r\n        fontSize: 20\r\n    },\r\n    buttonContainer : {\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-evenly'\r\n    }\r\n})\r\n"]},"metadata":{},"sourceType":"module"}